#prac1doe
y=c(31,10,21,4,1,62,40,24,30,35,53,27,120,97,68);y
d=matrix(y,ncol=3,nrow=5,byrow=TRUE);d
colnames(d)=paste("Method",1:3);d
t=3
n=n1=n2=n3=5
N=15
#H0:All treatment means are effective.
#H1:Atleast one treatment mean is not effective
Y..=sum(d)
Ct=(Y..^2)/N
TSS=sum(d^2)-Ct;TSS
Y.j=colSums(d)
SSt=(sum(Y.j^2)/n)-Ct;SSt
Sse=TSS-SSt;Sse
F0=(SSt/(t-1))/(Sse/(N-t));F0
Mse=Sse/(N-t)
qf(0.95,t-1,N-t)
#fisher Lsd for equal sample size
yi.=colMeans(d);yi.
diff=matrix(ncol=t,nrow=t)
for(i in 1:t)
{
  for(j in 1:t)
  {
    if(i<j)
      diff[i,j]=abs(yi.[i]-yi.[j])
  }
}
diff
diff=na.omit(c(diff));diff
cf=qt(0.975,N-t)*sqrt(Mse*(2/n));cf
#estimability
x=matrix(c(rep(1,15),rep(1,5),rep(0,15),rep(1,5),rep(0,15),rep(1,5)),ncol=4,byrow=FALSE);x
s=t(x)%*%x
library(MASS)
h=ginv(s)%*%s
l1=c(1,0,0,0)
l2=c(0,1,1,0)
l3=c(0,1,1-2)
round(l1%*%h,4)
###q2
y=c(3129,3000,2865,2890,3300,3150,2800,2900,2985,3050,2600,2700,2600)
n=c(4,2,4,3)
t=4
N=sum(n)
a=rep(1:t,n)
Yj.=c()
for(i in 1:t)
{
  Yj.[i]=sum(y[a==i])
}
Yj.
Y..=sum(y)
Ct=(Y..^2)/N;Ct
TSS=(sum(y^2))-Ct;TSS
Sst=(sum(Yj.^2)/n)-Ct;Sst
sse=TSS-Sst
mse=sse/(N-t)
F1=(Sst/(t-1))/mse;F1
###########
y=c(175,190,185,95,100,85,180,180,175,170,200,195,155,160,145)
n=n1=n2=n3=n4=3
d=matrix(y,nrow=3,ncol=5,byrow=FALSE);d
colnames(d)=paste("Machine",1:5);d
Yi.=colSums(d)
Y..=sum(y)
N=15
CT=(Y..^2)/N
TSS=sum(y^2)-CT;TSS
SST=(sum(Yi.^2))/n-CT;SST
SSE=TSS-SST;SSE
t=5
MSE=SSE/(N-t)
MSA=SST/(t-1)
F1=MSA/MSE;F1
qf(0.95,t-1,N-t)
#estimability
x=matrix(c(rep(1,15),rep(1,3),rep(0,15),rep(1,3),rep(0,15),rep(1,3),rep(0,15),rep(1,3),rep(0,15),rep(1,3)),ncol=6,byrow=FALSE);x
s=t(x)%*%x
library(MASS)
h=ginv(s)%*%s
lambda1=c(0,1,1,1,-3,0)
round(lambda1%*%h,2)
lambda2=c(1,1,0,0,0,0)
round(lambda2%*%h,2)
S=sqrt(MSE*(4/3))
S_crit=S*sqrt(4*(qf(0.95,4,11)))
S_crit;
######q3
y=c(3,13,13,8,11,9,12,7,16,15,18,12,8,10,18,6,21,34,26,11,2,5,5,26,24,14,21,5,17,17,23,19,7,27,25,12,30,27,20,17,23,13,28,12,13)
n=c(14,10,11,10)
t=4
N=sum(n);N
t1=c(rep(1,n[1]),rep(2,n[2]),rep(3,n[3]),rep(4,n[4]))
yi.=c()
Yi.=c()
y..=mean(y)
ssh0=0
ssr=0
for(i in 1:4)
{
  yi.[i]=mean(y[t1==i])
  Yi.[i]=sum(y[t1==i])
  ssh0=ssh0+n[i]*(yi.[i]-y..)^2
  ssr=ssr+(Yi.[i]^2)/n[i]
}

ssh0
sst=sum(y^2)
sse=sst-ssr
F1=(ssh0/(k-1))/(sse/(N-t));F1
mse=sse/(N-t)
tf=qf(0.95,t-1,N-t)
#scheffe test
cn=matrix(c(1,0,0,-1,0,1,0,-1,0,0,1,-1),ncol=4,byrow=TRUE);cn
scu=c()
for(i in 1:3)
{
  scu[i]=sqrt(mse*sum((cn[i,]^2)/n))
}
co=scu*sqrt((t-1)*tf)
diff
diff>co

